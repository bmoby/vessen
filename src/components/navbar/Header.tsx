"use client";

import Link from "next/link";
import { useEffect, useState } from "react";
import styles from "./header.module.css";

type HeaderProps = {
  variant?: "default" | "over-hero";
};

export default function Header({ variant = "default" }: HeaderProps) {
  const [isScrolled, setIsScrolled] = useState(false);
  const [isMenuOpen, setIsMenuOpen] = useState(false);

  useEffect(() => {
    if (variant !== "over-hero") return;

    const handleScroll = () => {
      // Détecter si on a dépassé le Hero (environ 600px)
      setIsScrolled(window.scrollY > 600);
    };

    window.addEventListener("scroll", handleScroll);
    return () => window.removeEventListener("scroll", handleScroll);
  }, [variant]);

  const headerVariant =
    variant === "over-hero" && !isScrolled ? "over-hero" : "default";

  return (
    <header className={styles.header} data-variant={headerVariant}>
      <div className={styles.container}>
        <Link href="/" className={styles.brand}>
          <svg
            viewBox="0 0 107.84597 20.703186"
            className={styles.logo}
            aria-label="Logo VESSEN"
            role="img"
          >
            <path
              d="m 32.766699,15.033871 c 0.25428,0.287232 0.56889,0.452403 0.94241,0.4959 0.37938,-0.0435 0.69339,-0.205987 0.94248,-0.487786 0.1681,-0.189406 0.3955,-0.568889 0.68291,-1.137391 l 4.06291,-8.1093021 h -1.62522 l -3.65668,7.2966791 c -0.15712,0.30861 -0.29002,0.463303 -0.39832,0.463303 -0.10809,0 -0.2407,-0.154693 -0.398,-0.463303 l -3.68939,-7.2966791 h -1.60842 l 4.06263,8.1093021 c 0.28169,0.552309 0.50937,0.929288 0.68269,1.129277 z M 7.6892125,6.8666779 c 0.72937,0.05091 1.36017,0.35052 1.82887,0.65592 -0.31429,0.378671 -0.53287,0.82938 -0.61718,1.322175 0.6593,-0.811671 1.8091095,-1.350786 3.1199995,-1.350786 1.3112,0 2.4608,0.539115 3.12011,1.350786 -0.0834,-0.487574 -0.29891,-0.933873 -0.60801,-1.310287 0.47071,-0.309703 1.10789,-0.616514 1.846787,-0.667808 1.5634,-0.109079 2.12689,1.545096 1.1817,2.817918 -0.94548,1.2725751 -1.452387,2.4908931 -1.452387,2.4908931 -1.31999,0.493184 -2.48821,0.899901 -4.07419,0.90678 -1.5868,-0.0069 -2.7551295,-0.413596 -4.0751195,-0.90678 0,0 -0.5069,-1.218318 -1.45221,-2.4908931 -0.94537,-1.272822 -0.3816,-2.926997 1.18163,-2.817918 z m 4.3456995,-2.107495 c 2.2473,0.01679 3.38109,1.543897 3.38109,1.543897 -0.50289,0.306423 -0.86692,0.649605 -1.12981,0.96139 -0.57379,-0.548181 -1.37601,-0.888788 -2.26529,-0.888788 -0.88149,0 -1.67739,0.335209 -2.2500895,0.874606 -0.26201,-0.307904 -0.62261,-0.645301 -1.11813,-0.947208 0,0 1.13411,-1.527104 3.3822295,-1.543897 z m 3.59847,11.1196971 c -1.23088,0.725311 -3.30479,0.875206 -3.59847,0.861695 -0.2944,0.01351 -2.3683095,-0.136384 -3.5992195,-0.861695 0,0 0.22631,-1.394495 -0.20969,-2.80349 0,0 1.36331,0.709084 3.8089095,0.736106 2.44489,-0.02702 3.8082,-0.736106 3.8082,-0.736106 -0.43621,1.408995 -0.20973,2.80349 -0.20973,2.80349 z m -7.7963895,0.3429 c -0.0435,0.124989 0.0214,0.261197 0.1476,0.301096 0.29979,0.09603 0.8629,0.291712 1.60472,0.621912 1.0275695,0.457588 2.2323795,0.483482 2.4455995,0.484787 0.21247,-0.0013 1.41689,-0.0272 2.44489,-0.484787 0.74189,-0.3302 1.3051,-0.525886 1.60471,-0.621912 0.12658,-0.0399 0.1911,-0.176107 0.14739,-0.301096 -0.19769,-0.564198 -0.53019,-2.140691 0.783977,-4.359981 1.66342,-2.8088161 2.30442,-3.0954131 2.24991,-4.1862021 -0.0547,-1.090718 -0.941,-1.663206 -1.92271,-1.922603 -0.97747,-0.257704 -2.200267,-2.043324 -5.308167,-2.057506 -3.1087195,0.01418 -4.3315195,1.799802 -5.3090995,2.057506 -0.9816,0.259397 -1.8681,0.831885 -1.92271,1.922603 -0.0543,1.090789 0.58628,1.377386 2.24998,4.1862021 1.31431,2.21929 0.98161,3.795783 0.78391,4.359981 z m 0.9066,-0.720584 c 0.32911,0.486798 1.6704095,0.985591 3.2773095,0.985591 1.6069,0 2.94869,-0.498793 3.27709,-0.985591 -0.76919,0.247897 -1.951,0.613304 -3.27709,0.613304 -1.32641,0 -2.5082095,-0.365407 -3.2773095,-0.613304 z m 97.4785975,3.57819 H 24.593409 V 1.6237999 h 81.628781 z m -83.252801,0 H 1.6238025 V 1.6237999 H 22.969389 Z M 2.4591476e-6,20.703187 H 107.84599 V -7.6141959e-8 H 2.4591476e-6 Z M 74.613589,13.904383 h -1.10501 -7.5734 l 0.0162,1.60909 h 5.68819 2.84388 c 1.89611,0 2.8441,-0.812483 2.8441,-2.437695 l -0.0162,-0.828781 v -0.795725 -1.6094781 -1.06e-4 h -9.7462 l 0.004,-1.226996 c 0.005,-0.817598 0.36562,-1.226714 1.08081,-1.226714 h 1.10521 7.57298 l -0.0162,-1.60909 h -5.68819 -2.84392 c -1.8959,0 -2.84409,0.8128 -2.84409,2.437694 l 0.0162,0.828816 v 0.79629 1.6089141 6.7e-4 h 9.73469 v 1.218106 c 0,0.823419 -0.3575,1.235005 -1.07251,1.235005 z m -12.64349,0 h -1.10511 -7.57329 l 0.0164,1.60909 h 5.68798 2.84413 c 1.89569,0 2.84367,-0.812483 2.84367,-2.437695 l -0.0158,-0.828781 v -0.795725 -1.6094781 -1.06e-4 h -9.74679 l 0.004,-1.226996 c 0.006,-0.817598 0.3658,-1.226714 1.08113,-1.226714 h 1.10507 7.5728 l -0.0158,-1.60909 h -5.68798 -2.84452 c -1.8959,0 -2.84388,0.8128 -2.84388,2.437694 l 0.0164,0.828816 v 0.79629 1.6089141 6.7e-4 h 9.73438 v 1.218106 c 0,0.823419 -0.35758,1.235005 -1.07238,1.235005 z m 30.87698,-5.1189111 7.215721,5.8501131 c 0.59581,0.563492 1.0723,0.85591 1.4296,0.877994 h 0.30878 c 0.54212,0 0.8128,-0.324909 0.8128,-0.974902 V 12.230593 5.7955029 h -1.625 l -0.0164,6.7600691 -7.410381,-6.2402861 c -0.4553,-0.325014 -0.8236,-0.498298 -1.10529,-0.519783 h -0.42242 c -0.54169,0 -0.81301,0.324874 -0.81301,0.974867 v 2.307731 6.4354781 h 1.6256 z m -2.8926,5.1189111 h -11.35958 v 1.625388 h 11.35958 z m 0.0164,-8.1254951 h -11.37599 v 1.625106 h 11.37599 z m -0.0164,4.062906 h -11.35958 v 1.6252821 h 11.35958 z m -37.9301,4.0625891 h -11.35958 v 1.625388 h 11.35958 z m 0,-4.0625891 h -11.35958 v 1.6252821 h 11.35958 z m 0.0161,-4.062906 h -11.3757 v 1.625106 h 11.3757 z"
              fill="currentColor"
            />
          </svg>
        </Link>

        <button
          className={styles.menuToggle}
          aria-label="Toggle menu"
          aria-expanded={isMenuOpen}
          aria-controls="primary-nav"
          data-open={isMenuOpen ? "true" : "false"}
          onClick={() => setIsMenuOpen((v) => !v)}
        >
          <span className={styles.burger} />
        </button>

        <nav
          id="primary-nav"
          className={styles.nav}
          aria-label="Primary"
          data-open={isMenuOpen ? "true" : "false"}
          onClick={() => setIsMenuOpen(false)}
        >
          <Link href="/">Главная</Link>
          <Link href="/products">Прайслист</Link>
          <Link href="/promotions">Акции</Link>
          <Link href="/trends">Тренды</Link>
          <Link href="/contact">Контакт</Link>
        </nav>
      </div>
    </header>
  );
}
